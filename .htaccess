# Enable rewrite engine (used for clean URLs)
RewriteEngine On
RewriteBase /

# Redirect www to non-www (optional, remove if you prefer www)
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ https://%1%{REQUEST_URI} [L,R=301]

# Force HTTPS (InfinityFree gives free SSL via Cloudflare or their SSL panel)
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Custom error pages
ErrorDocument 400 /errors/400.php
ErrorDocument 401 /errors/401.php
ErrorDocument 403 /errors/403.php
ErrorDocument 404 /errors/404.php
ErrorDocument 429 /errors/429.php

# Security: Block directory browsing
Options -Indexes

# Security: Prevent access to .htaccess itself
<Files ".htaccess">
    Require all denied
</Files>

# Pretty URLs for blog posts (virtual /blog path)
RewriteRule ^blog/([a-zA-Z0-9_-]+)$ /post.php?slug=$1 [L,QSA]

# prevent .env file access
<Files .env>
  Order allow,deny
  Deny from all
</>